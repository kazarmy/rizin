NAME=dbg_aslr
FILE=bins/elf/analysis/pie
ARGS=-d
CMDS=pi 3 @ entry0
EXPECT=<<EOF
xor ebp, ebp
pop esi
mov ecx, esp
EOF
RUN

NAME=restore fd
FILE=bins/elf/analysis/pie
ARGS=-d
CMDS=<<EOF
s main
p8 8
p8 8 @v:0xdeadbeef
p8 8
EOF
EXPECT=<<EOF
5589e5cc5dc36690
efbeadde5dc36690
5589e5cc5dc36690
EOF
RUN

NAME=dk 9
FILE=bins/elf/analysis/calls_x64
ARGS=-a x86 -d
CMDS=<<EOF
dk 9
dc
EOF
EXPECT=<<EOF
EOF
REGEXP_FILTER_ERR=child.*signal [0-9]+.*
EXPECT_ERR=<<EOF
child received signal 9
EOF
RUN
